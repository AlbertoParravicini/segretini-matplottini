# segretini-matplottini

A collection of Matplotlib and Seaborn recipes and utilities collected over years of colorful plot-making,
to help researchers create publication-ready plots with ease.

## üöÇ Installation

Clone the repository and install `segretini-matplottini` with `pip`.

```shell
git clone https://github.com/AlbertoParravicini/segretini-matplottini.git
cd segretini-matplottini
pip install .
```

# TODO

[x] rename files in `data` to end with `data.csv`
[x] delete scratchbook
[x] add ruff and isort
[x] add pre-commit hooks
[x] linting
[x] reverse gitignore
[x] new code structure in readme, with tree
[x] modify plots structure not to have dates
[x] recreate sample plots
[x] create imports for utils inside __init__, to hide private stuff
[x] changelog
[x] timeseries plot for video frames
[x] minor tick locator for timeseries (same as major, but check that interval is < than major.<- automatic, not necessaty)
[x] new barplot code
    [x] e2e test
[] other barplot
    [] e2e test
[] plot for tp/tn/f1/etc. Have setting that says which should be plotten, and setting for nrows/ncols (default=plot all, nrows/cols is sqrt (e.g. 4 -> 2,2))
    [] e2e test
[x] all plots must have fontsize base 10 (or 8?). And specify figsize and subplot adjust as params
    [x] for ridgeplot, no subplot adjust except horizontal, since it's specific to dataset size
    [x] split ridgeplot in ridgeplot and ridgeplot_compact
[] ranz unused colors/palettes, add some new sample colors (e.g. green used in new plots, pink used in timeseries)
[x] add util for arrow of metric
[x] add util for color palette
[] add image with plot grid inside readme
[] add list of examples to readme, add images for the pretties ones
[] compute_speedup should not mention speedup, and clean API. Maybe ranz correct_speedup, and add test
[] tests
    [] unit tests
    [x] e2e tests for examples, check if they don't crash
[] github
    [] protect master branch
    [] add automated tests check
    [] add automated linting check
[x] revisit save_plot. Take as input a path or a list of paths. And have another function to assemble the paths from root dir, plot name (not as format string), folder date (as format string, e.g Y_M_D) and suffix date (_Y_M_D_H_M_S), extensions
[x] revisit add_labels: create get_labels_for_barplot and add_labels_to_barplot that takes mandatory labels (and checks that num labels == num bars)
[] create notebook to create good plot from scratch (some barplot)
[] can we create auto documentation?
[] update changelog
[] delete this list

## ‚úçÔ∏è Repository Structure

These are the most important folders of `segretini-matplottini`, so you won't get lost when exploring the code.

```
segretini-matplottini (this folder)
    ‚îú‚îÄ‚îÄ segretini_matplottini
    ‚îÇ   ‚îú‚îÄ‚îÄ plot              -> Ready-made plotting functions, e.g. ridgeplots, and Roofline plots
    ‚îÇ   ‚îî‚îÄ‚îÄ utils             -> Other setup files (constants, metadata, etc.)
    ‚îÇ       ‚îú‚îÄ‚îÄ constants.py  -> Default values for shared settings (font size, DPI, etc.)
    ‚îÇ       ‚îú‚îÄ‚îÄ colors.py     -> List of predefined and pretty colors, plus color-related utilities
    ‚îÇ       ‚îú‚îÄ‚îÄ data.py       -> Utilities to preprocess datasets (e.g. outlier removal)
    ‚îÇ       ‚îú‚îÄ‚îÄ legend.py     -> Legend-related utilities, e.g. custom legend styles
    ‚îÇ       ‚îî‚îÄ‚îÄ plot.py       -> General utilities for plotting (e.g. labels, saving plots)
    ‚îú‚îÄ‚îÄ data         -> Sample data used in example plots
    ‚îú‚îÄ‚îÄ examples     -> Recipes to create fancy plots
    ‚îú‚îÄ‚îÄ plots        -> Plots generated by examples. If you find something cool, check the code in examples
    ‚îú‚îÄ‚îÄ CHANGELOG.md -> List of updates to the codebase. Check there to see what's new
    ‚îú‚îÄ‚îÄ README.md   -> This file!
    ‚îú‚îÄ‚îÄ checks.py   -> Run linters and validators
    ‚îî‚îÄ‚îÄ (...)       -> Configuration files for linters, and other setup files.
```

## üë®‚Äçüî¨ Development notes

If you want to hack `segretini-matplottini` itself, you will most likely want to clone it with SSH, install it inside a `conda` environment, in `editable` mode, and with `dev` dependencies. Also install the `pre-commit` hooks to obtain linting and quality checks when creating a commit.
    
```shell
git clone git@github.com:AlbertoParravicini/segretini-matplottini.git
cd segretini-matplottini
conda create -n segretini_matplottini python=3.9
conda activate segretini_matplottini
pip install -e ".[dev]"
pre-commit install
```

We use `black`, `mypy`, and `ruff` for formatting, type checking, linting, and sorting imports. Each commit must pass their checks. To run checks manually, run the following. Checks are also ran when creating a commit. You won't be able to commit if a check fails.

```shell
black . --config pyproject.toml 
mypy . --config mypy.ini
ruff . --fix --config ruff.toml
```

## üí° Tips and Tricks

An ever-growing collection of tips I've found or discovered along the way, together with some nice resources I like a lot.

### üìö Resources 

* [Subtleties of Color](https://earthobservatory.nasa.gov/blogs/elegantfigures/2013/08/05/subtleties-of-color-part-1-of-6/): a six-parts guide on how to pick nice colors and create great palettes, from the Earth Observatory NASA blog.
* [Adobe Color](https://color.adobe.com/create/color-wheel): a free web tool to create palettes of different types (shades, complementary, etc.). It also has accessibility tools to test for color blindness safety.

### üé® Colors

Picking the right colors is hard! I found the following tips to be very helpful.

* **Not everyone sees colors in the same way**: most reviewers will look at your papers after printing them in black & white. Always check for that! You can do it with `matplotlib` (check out `hex_color_to_grayscale` in `src/plot_utils.py`) or doing a print preview after saving your plot as PDF.
If colors are too similar, try adjusting the **L** (lightness) in the **HSL** representation, or the **B** (brightness) in the **HSB** representation. 
Also, a lot of people are color blind, and there are many types of color blindness! It's always better to double check.

* **Hidden color biases**: people tend to associate implicit meanings to colors. To simplify the matter a lot, green is usually associated to positive things, while red is bad. 
If your plot is not explicitely comparing classes (for example, you want to show the speed of your algorithm on different datasets), just go for a neutral/positive palette, using colors such as gree, blue, and light pink.

* **Add redundant information**: if you are plotting many different classes, and use one color per class, it can be difficult to distinguish among them. Instead, add some kind of redundant information.
In scatterplots and lineplots you can use different markers (circles, diamonds, etc.), while in barplots you can use different hatches (//// or \\\\) or add labels to each class.
